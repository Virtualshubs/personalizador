<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Movimiento fluido + OrbitControls (sin módulos)</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      font-family: sans-serif;
    }

    #canvas-container {
      width: 100vw;
      height: 100vh;
      position: relative;
    }

    .controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 10;
    }

    .controls button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="canvas-container"></div>
  <div class="controls">
    <button data-dir="forward">⬆️</button>
    <button data-dir="left">⬅️</button>
    <button data-dir="backward">⬇️</button>
    <button data-dir="right">➡️</button>
  </div>

  <!-- ✅ Three.js r134 clásica -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/build/three.min.js"></script>
  <!-- ✅ OrbitControls compatible r134 -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/controls/OrbitControls.js"></script>

  <script>
    const container = document.getElementById('canvas-container');

    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 100);
    camera.position.set(0, 5, 10);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    container.appendChild(renderer.domElement);

    // Orbit Controls
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
    controls.target.set(0, 1, 0);

    // Luces tipo estudio
    const ambient = new THREE.AmbientLight(0xffffff, 0.4);
    scene.add(ambient);

    const light1 = new THREE.DirectionalLight(0xffffff, 0.6);
    light1.position.set(5, 10, 5);
    scene.add(light1);

    const light2 = new THREE.DirectionalLight(0xffffff, 0.3);
    light2.position.set(-5, 10, -5);
    scene.add(light2);

    // Suelo negro
    const plane = new THREE.Mesh(
      new THREE.PlaneGeometry(50, 50),
      new THREE.MeshStandardMaterial({ color: 0x000000 })
    );
    plane.rotation.x = -Math.PI / 2;
    scene.add(plane);

    // Esfera
    const sphere = new THREE.Mesh(
      new THREE.SphereGeometry(1, 32, 32),
      new THREE.MeshStandardMaterial({ color: 0x00ffff })
    );
    sphere.position.y = 1;
    scene.add(sphere);

    // Movimiento fluido
    const directions = {
      forward: false,
      backward: false,
      left: false,
      right: false
    };

    const buttons = document.querySelectorAll('.controls button');
    buttons.forEach(btn => {
      const dir = btn.getAttribute('data-dir');
      btn.addEventListener('mousedown', () => directions[dir] = true);
      btn.addEventListener('mouseup', () => directions[dir] = false);
      btn.addEventListener('mouseleave', () => directions[dir] = false);
      btn.addEventListener('touchstart', e => {
        e.preventDefault();
        directions[dir] = true;
      }, { passive: false });
      btn.addEventListener('touchend', () => directions[dir] = false);
    });

    const speed = 0.05;

    function animate() {
      requestAnimationFrame(animate);

      if (directions.forward) sphere.position.z -= speed;
      if (directions.backward) sphere.position.z += speed;
      if (directions.left) sphere.position.x -= speed;
      if (directions.right) sphere.position.x += speed;

      controls.update();
      renderer.render(scene, camera);
    }

    animate();

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
