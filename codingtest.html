
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Three.js con menú canvas lateral</title>
  <style>
    body, html {
      margin: 0; padding: 0; height: 100%; overflow: hidden;
      font-family: Arial, sans-serif;
      background: #b3d9ff; /* azul cielo claro */
    }
    #scene-container {
      position: absolute;
      top: 0; left: 0; bottom: 0; right: 200px;
      background: #b3d9ff; /* mismo azul cielo */
    }
    #menu-canvas-container {
      position: fixed;
      top: 0; right: 0;
      width: 200px;
      height: 100%;
      background: #fff;
      box-shadow: -3px 0 6px rgba(0,0,0,0.1);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    canvas#menu-canvas {
      background: #eee;
      border-radius: 8px;
      cursor: pointer;
      user-select: none;
    }
  </style>
</head>
<body>
  <div id="scene-container"></div>
  <div id="menu-canvas-container">
    <canvas id="menu-canvas" width="180" height="400"></canvas>
  </div>

  <!-- Three.js r134 -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/build/three.min.js"></script>

  <script>
    // --- Three.js Setup ---
    const container = document.getElementById('scene-container');
    const scene = new THREE.Scene();

    // Cámara
    const camera = new THREE.PerspectiveCamera(60, container.clientWidth / container.clientHeight, 0.1, 100);
    camera.position.set(10, 10, 10);
    camera.lookAt(0,0,0);

    // Render
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    container.appendChild(renderer.domElement);

    // Fondo azul cielo (en escena, para Three.js se usa clearColor)
    renderer.setClearColor(0xb3d9ff, 1);

    // GridHelper (10x10)
    const gridHelper = new THREE.GridHelper(20, 20, 0x444444, 0x888888);
    scene.add(gridHelper);

    // Plano suelo
    const planeGeo = new THREE.PlaneGeometry(20, 20);
    const planeMat = new THREE.MeshStandardMaterial({ color: 0xa0a0a0, side: THREE.DoubleSide });
    const plane = new THREE.Mesh(planeGeo, planeMat);
    plane.rotation.x = -Math.PI / 2;
    plane.position.y = -0.01; // ligeramente debajo para evitar z-fighting con grid
    scene.add(plane);

    // Luz ambiente
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
    scene.add(ambientLight);

    // Luz direccional
    const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
    dirLight.position.set(10, 20, 10);
    scene.add(dirLight);

    // Render loop
    function animate() {
      requestAnimationFrame(animate);
      renderer.render(scene, camera);
    }
    animate();

    // Ajuste responsivo
    window.addEventListener('resize', () => {
      camera.aspect = container.clientWidth / container.clientHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(container.clientWidth, container.clientHeight);
    });

    // --- Canvas lateral menú ---
    const menuCanvas = document.getElementById('menu-canvas');
    const ctx = menuCanvas.getContext('2d');

    // Botones datos
    const buttons = [
      { text: 'Edita el entorno', x: 10, y: 20, width: 160, height: 60 },
      { text: 'Añade productos', x: 10, y: 110, width: 160, height: 60 },
      { text: 'Añade atención al cliente', x: 10, y: 200, width: 160, height: 60 }
    ];

    // Función para dibujar los botones
    function drawButtons() {
      ctx.clearRect(0, 0, menuCanvas.width, menuCanvas.height);
      buttons.forEach(btn => {
        // Fondo botón
        ctx.fillStyle = '#007BFF';
        ctx.roundRect(btn.x, btn.y, btn.width, btn.height, 12);
        ctx.fill();

        // Texto botón
        ctx.fillStyle = '#fff';
        ctx.font = '16px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(btn.text, btn.x + btn.width/2, btn.y + btn.height/2);
      });
    }

    // Dibujar los botones la primera vez
    drawButtons();

    // Función auxiliar para redondear rectángulos (añadido al contexto Canvas)
    CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
      if (w < 2 * r) r = w / 2;
      if (h < 2 * r) r = h / 2;
      this.beginPath();
      this.moveTo(x + r, y);
      this.arcTo(x + w, y, x + w, y + h, r);
      this.arcTo(x + w, y + h, x, y + h, r);
      this.arcTo(x, y + h, x, y, r);
      this.arcTo(x, y, x + w, y, r);
      this.closePath();
      return this;
    }

    // Detectar clic sobre botones
    menuCanvas.addEventListener('click', (e) => {
      const rect = menuCanvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;

      buttons.forEach((btn, i) => {
        if (
          mouseX >= btn.x &&
          mouseX <= btn.x + btn.width &&
          mouseY >= btn.y &&
          mouseY <= btn.y + btn.height
        ) {
          alert(`Has pulsado: "${btn.text}"`);
          // Aquí puedes enlazar la lógica real de cada botón
        }
      });
    });
  </script>
</body>
</html>
